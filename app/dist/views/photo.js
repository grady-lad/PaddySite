define(["backbone","handlebars","jquery","events"],function(e,t,n,r){var i=e.View.extend({events:{"click .singleIllLink":"singleIllView","click .remove":"removePhoto","click .crop":"showModal","click .closure":"closeModal","click .cropPrev":"showCrop","click .saveCrop":"saveCrop"},render:function(){"use strict";var e=n("#illustrationTemplate").html(),r=t.compile(e),i=r(this.model.attributes);return this.$el.html(i),this},singleIllView:function(e){"use strict";e.preventDefault();var t=this.model.get("_id"),n="photo?id="+t;r.trigger("router:navigate",n)},removePhoto:function(e){"use strict";e.preventDefault();var t=this;this.model.destroy({success:function(e,n){t.remove()},error:function(e,t){n(".status").text("Could not delete image")}})},showModal:function(e){e.stopPropagation(),this.$(".modalContainer").show(),n(".illRow").find(".editImage").addClass("no-hover")},closeModal:function(){this.$(".modalContainer").hide(),n(".illRow").find(".editImage").removeClass("no-hover")},showCrop:function(e){e.preventDefault(),e.stopPropagation();var t="",r=this.model.attributes.image.url,i="",s="",o=r.indexOf("upload"),u=this.checkOption(this.$(".cropSize").val())?"":this.$(".cropSize").val()+",",a=this.checkOption(this.$(".cropGravity").val())?"":this.$(".cropGravity").val();i=r.slice(0,o+6),s=r.slice(o+6),t=i+"/c_crop,h_"+u+a+s,this.$(".cropper").hide();var f=this,l=n("<img />").attr("src",t).load(function(){f.$(".cropper").attr("src",l.attr("src")),f.$(".cropper").css("background-image","none"),f.$(".cropper").css("max-heigth","100%"),f.$(".cropper").fadeIn()})},checkOption:function(e){return e==="Select Direction"||e==="Select Size"?(console.log("in the true with this "+e),!0):!1},saveCrop:function(e){e.preventDefault();var t=this,r=this.$(".cropSize").val(),i=this.$(".cropGravity").val();console.log("the size is "+r);var s=this.model.attributes.image.url,o=s.indexOf("upload"),u=s.slice(0,o+6),a=s.slice(o+6),f="";!this.checkOption(r)&&!this.checkOption(i)&&(f=u+"/c_crop,h_"+r+","+i+a,console.log("making the reuest with"),console.log("id "+this.model.id),console.log("url "+f),n.post("/updateCrops",{data:{id:this.model.id,cropped:f}}).done(function(e){t.model.set("croppedImage",f),alert("image Saved!")}).fail(function(e,t,n){console.log("uggh")}))}});return i});