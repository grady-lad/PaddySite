define(["backbone","views/photo"],function(e,t){var n=e.View.extend({initialize:function(){this.listenTo(this.collection,"reset",this.render),this.listenTo(this.collection,"add",this.tester)},setUpNewRow:function(){var e=$('<div class="row illRow"></div>');return $(".app").append(e),e},renderB:function(){var e=this,n=0,r;e.collection&&e.collection.each(function(i){var s=new t({model:i}),o="#"+i.attributes.image.public_id,u=i.attributes.image.url,a=u.indexOf("upload");i.attributes.image.url=u.slice(0,a+6)+"/h_400"+u.slice(a+6);if(n==0||n%3==0)r=e.setUpNewRow();var s=new t({model:i});r.append(s.render().el),$(".loading").hide(),$(o).bind("load",function(){$(this).fadeTo("slow",1)}),n++},e)},tester:function(e){var n=new t({model:e}),r=$(".illRow:last"),i=$(".illRow:last > div").size(),s;r.length>0&&i<=2?r.append(n.render().el):(s=this.setUpNewRow(),s.append(n.render().el))}});return n});